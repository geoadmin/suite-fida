<div *ngIf="activated" class="feature-edit fida-widget" [class.spinner]="showSpinner">
    <!-- header -->
    <div class="fida-widget-header">
        <label>Edit Attributes</label>
        <button class="btn esri-icon-close float-right" (click)="cancelClick()"></button>
    </div>

    <!-- body -->
    <div class="fida-widget-body container">

    
        <form #featureForm="ngForm" (ngSubmit)="featureForm.valid">
            <div [ngSwitch]="feature?.layer.id">

                 <!-- lfp feature -->
                <app-lfp-edit *ngSwitchCase="'LFP'" [feature]="feature"></app-lfp-edit>

                 <!-- default -->
                <div *ngSwitchDefault>
                    <!-- tab nav -->
                    <ul class="nav nav-tabs" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active" href="#general_tab" role="tab" data-toggle="tab">Allgemein</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#grundbuch_tab" role="tab" data-toggle="tab">Grundbuch</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#nachfuehrung_tab" role="tab" data-toggle="tab">Nachfuehrung</a>
                        </li>
                    </ul>

                    <!-- tab panes -->
                    <div class="tab-content">

                        <!--general attributes -->
                        <div role="tabpanel" class="tab-pane fade in active show py-2" id="general_tab">
                            <div *ngFor="let attribute of feature?.attributes | keyvalue">
                                <div class="row">
                                    <div class="col-6 attribute-label">
                                        {{ attribute.key }}
                                    </div>
                                    <div class="col-6">
                                        <input type="text" class="form-control" name="{{ attribute.key }}" [(ngModel)]="feature?.attributes[attribute.key]">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div role="tabpanel" class="tab-pane fade py-2" id="grundbuch_tab">
                            <!-- add grundbuch buttons -->
                            <div class="d-flex felx-row mb-2">
                                <button type="button" class="btn btn-primary"
                                    (click)="addRelatedFeatureClick('grundbuch')">add</button>
                            </div>
                            <div *ngFor="let relatedFeature of getRelatedFeatures(feature?.relatedFeatures.grundbuch)">
                                <div *ngIf="relatedFeature.state !== 'deleted'">
                                    <div>---------{{ relatedFeature.attributes.OBJECTID }}--------------</div>
                                    <div *ngFor="let attribute of relatedFeature.attributes | keyvalue let idx=index">
                                        <div class="row">
                                            <div class="col-6 attribute-label">
                                                {{ attribute.key }}
                                            </div>
                                            <div class="col-6">
                                                <input type="text" class="form-control" name="{{ attribute.key }}" [(ngModel)]="relatedFeature?.attributes[attribute.key]">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="d-flex felx-row mb-2">
                                        <button type="button" class="btn btn-danger"
                                            (click)="deleteRelatedFeatureClick(relatedFeature)">delete</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div role="tabpanel" class="tab-pane fade py-2" id="nachfuehrung_tab">
                            <!-- add nachfÃ¼hrung buttons -->
                            <div class="d-flex felx-row mb-2">
                                <button type="button" class="btn btn-primary"
                                    (click)="addRelatedFeatureClick('nachfuehrung')">add</button>
                            </div>
                            <div
                            *ngFor="let relatedFeature of getRelatedFeatures(feature?.relatedFeatures.nachfuehrung)">
                            <div *ngIf="relatedFeature.state !== 'deleted'">
                                <div>---------{{ relatedFeature.attributes.OBJECTID }}--------------</div>
                                <div *ngFor="let attribute of relatedFeature.attributes | keyvalue let idx=index">
                                    <div class="row">
                                        <div class="col-6 attribute-label">
                                            {{ attribute.key }}
                                        </div>
                                        <div class="col-6">
                                            <input type="text" class="form-control" name="{{ attribute.key }}" [(ngModel)]="relatedFeature?.attributes[attribute.key]">
                                        </div>
                                    </div>
                                </div>
                                <div class="d-flex felx-row mb-2">
                                    <button type="button" class="btn btn-danger"
                                        (click)="deleteRelatedFeatureClick(relatedFeature)">delete</button>
                                </div>
                            </div>
                        </div>
                        </div>
                    </div>


                </div>

            </div>
          
        </form>


    </div>

    <!-- footer -->
    <div class="fida-widget-footer d-flex felx-row">
        <button type="button" class="btn btn-primary" (click)="saveClick()">Save</button>
        <button type="button" class="btn btn-default ml-2" (click)="cancelClick()">Cancel</button>
    </div>
</div>